\documentclass[a4paper, twoside]{report}
%% Language and font encodings
\usepackage[english]{babel}
\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}

%% font size related
% \linespread{1.15}
% \setlength{\parskip}{5pt}

%% Chapter Beautify
\usepackage{titlesec}
% \newcommand{\hsp}{\hspace{20pt}}
% \titleformat{\chapter}[hang]{\Huge\bfseries}{\thechapter\hsp|\hsp}{0pt}{\Huge\bfseries}

%% Very nice Font
\usepackage{palatino}

%% Diagram drawing
\usepackage{tikz}
\usetikzlibrary{shapes.geometric, arrows}

%% Forced float
\usepackage{float}

%% Source code highlight
\usepackage{minted}
\usepackage{listings}

%% figure

%% Code line references
\setminted[haskell]{escapeinside=\#\#, linenos=true, mathescape=true}
\usepackage{caption}
\usepackage{tikz}
\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,inner sep=1pt, text=white] (char) {#1};}}
\newcommand*\clabel[1]{$\label{#1} \circled{\ref{#1}}$}
\newcommand*\cref[1]{\circled{\ref{#1}}}
\newcommand*\ccaption[2]{
    \caption[.]{
        \centering #1\newline
        \begin{minipage}{\linewidth}
            #2
        \end{minipage}
        \newline
    }
}

\newenvironment{code}{\captionsetup{type=listing}}{}
%% Automatic Reference

% BNF Rule
\usepackage{mathtools,array}
\newenvironment{grammar}[2]
 {\begin{tabular}{@{\qquad}>{$}l<{$}@{\qquad}l@{}}
  \multicolumn{1}{@{}l@{}}{$#1$}&\multicolumn{1}{l@{}}{\hspace{-2em}#2}\\}
 {\end{tabular}}

%% Placeholder picture
\usepackage{mwe}

%% Format Paragraph
\setcounter{secnumdepth}{4}
\titleformat{\paragraph}
{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titlespacing*{\paragraph}
{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

%% Sets page size and margins
\usepackage[a4paper,top=3cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}

%% Useful packages
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage[colorlinks=true, allcolors=black]{hyperref}

%% Reference for figure, section and source code
\newcommand*{\tabref}[1]{\tablename~\ref{#1}}
\newcommand*{\figref}[1]{\figurename~\ref{#1}}
\newcommand*{\coref}[1]{\lstlistingname~\ref{#1}}
\newcommand*{\secref}[1]{Section~\ref{#1}}

%% Line number
% \usepackage{lineno}
% \linenumbers

%% for example
\usepackage{xspace}
\newcommand*{\eg}{e.g.\@\xspace}

%% Nested list
\usepackage{enumitem}
\setlist[enumerate]{label*=\arabic*.}

%% Haskell 
\newcommand*{\hask}[1]{\mintinline{text}{#1}}

%% https://tex.stackexchange.com/questions/375992/bad-mathchar-with-semantic-package
\usepackage{semantic}

\title{TODO}
\author{Shuhao Zhang}
% Update supervisor and other title stuff in title/title.tex

\begin{document}
\input{title/title.tex}

% TODO
% \begin{abstract}
% TBD
% \end{abstract}

% \renewcommand{\abstractname}{Acknowledgements}
% \begin{abstract}
% TBD
% \end{abstract}

\tableofcontents
% \listoffigures
% \listoftables

\input{introduction/introduction.tex}
\input{background/background.tex}
% \input{project/project.tex}
% \input{plan/plan.tex}
\chapter{Alg and ParAlg: An overview}
\section{Syntax}
\section{Compilation from Alg to ParAlg}
\section{Multiparty session types for ParAlg}
\section{Global types and protocols}
\section{Example: Parallel merge sort}

\chapter{SPar: A session typed free monad EDSL for concurrency}
% \section{Core: EDSL for computation}
\section{Computation: The Core EDSL}
\subsection{Syntax}
\subsection{Representation of recursive data structures}
\subsection{Semantics}
% \section{Proc: EDSL for communication}
\section{Communication: The Proc EDSL}
\subsection{Syntax}
\subsection{Representation in Haskell}
\subsection{Semantics}
\subsection{Session typing}
\section{Parallel computation: A group of Procs}
\subsection{Duality check}

\chapter{SPar: Implementation}
\section{Session type}
\subsection{Representations of session types in Haskell}
\subsection{Type-indexed Free Monad}
\subsection{Type-level duality check}
\subsection{Value-level duality check}
\section{SPar interpreter}
\subsection{Overview}
\subsection{Implementation}

\input{arrow/arrow.tex}
\input{codegen/codegen.tex}

% \input{evaluation/evaluation.tex}
\chapter{Parallel algorithms and evaluation} \label{eval}
\section{Parallelized algorithms}
\subsection{Merge sort}
\subsection{Quick sort}
\section{Benchmarks}
\subsection{Benchmarks against generated Haskell code}
\subsection{Benchmarks against C implementation}
\section{Evaluation}
\subsection{Design choices: Why Haskell?}

\chapter{Conclusions and future work}
% \section{Visualization of the compilation process}
% \section{Design choices}
% \subsection{Why Haskell?}
\section{Future work}
% \input{conclusion/conclusion.tex}
% \input{appendix/appendix.tex}

\bibliographystyle{ieeetr}
\bibliography{bibs/main}

\end{document}